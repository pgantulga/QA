<ng-container *ngIf="post$ | async as post">
    <header [pageTitle]="post.title">
        <div sub-nav fxLayout="row" fxLayoutAlign="start center" style="margin-top: 16px">
            <p class="mat-caption" style="color: #ffffff">Сүүлд шинэчлэгдсэн {{post.updatedAt | momentPipe}}</p>
            <div fxLayout="row" fxLayoutAlign="start center" class="time">
                <mat-icon style="color: #ffffff">visibility</mat-icon>
                <p class="mat-caption" style="color: #ffffff">12</p>
            </div>
        </div>
    </header>
    <div fxLayout="column" class="post-detail">
        <div class="view" fxFlex="">
            <div [innerHTML]="post.content"></div>
            <mat-chip-list>
                <mat-chip class="tag">Байгал орчин</mat-chip>
                <mat-chip class="tag">ХУУ</mat-chip>
            </mat-chip-list>
            <div fxlayout="row" fxLayoutAlign="space-between center">
                <div fxLayout="row" fxLayoutAlign="start start">
                    <div fxLayout="row" fxLayoutAlign="start center" class="replies">
                        <mat-icon>reply</mat-icon>
                        <p class="mat-caption">{{post.answersCount}}</p>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start center" class="votes">
                        <mat-icon>done</mat-icon>
                        <p class="mat-caption">{{post.totalVotes}}</p>
                    </div>
                </div>
                <user-profile [user]="post.author"></user-profile>
            </div>
        </div>

        <ng-container *ngIf="authService.user$ | async as user">
            <ng-container *ngIf="authService.canDelete(user)">
                <div class="log-section" *ngIf="logs$ | async as logs">
                    <div *ngFor="let log of logs">
                        <p>{{log.user.displayName}} {{log.type}} {{log.timestamp | momentPipe}}</p>
                    </div>
                </div>
            </ng-container>
        </ng-container>
    </div>
    <mat-divider></mat-divider>
    <div *ngIf="answers$ | async as answers; else loading" class="answers">
        <ng-container *ngIf="answers.length; else noItems" >
            <p class="mat-body-2">Хариултууд</p>
            <answer-list *ngFor="let item of answers; last as last"  [answer]="item">
                <mat-divider *ngIf="!last" answer-divider style="margin-top: 12px"></mat-divider>
            </answer-list>
        </ng-container>
        <ng-template #noItems>Хариулт олдсонгүй</ng-template>
    </div>
    <ng-template #loading>
        <div style="padding: 8px 22px" >
            <p class="mat-caption">Ачааллаж байна. </p>
        </div>
    </ng-template>
    <mat-divider></mat-divider>
    <ng-container *ngIf="authService.user$ | async as user">
        <answer-add [post]="post" [user]="user"></answer-add>
    </ng-container>
</ng-container>
